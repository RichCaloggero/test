<!doctype html>
<html>
<head>
<meta charset="utf-8">
<title>Firefox Click Test</title>
</head>
<body>
<h1>Firefox Click Test</h1>

<div id="test1" tabindex="0">
<p>Some dummy text,
<button id="dummy">a dummy button</button>,
and more text.
</p></div>


<div id="test2" tabindex="0">
<div id="child-1" >
<div id="child-1.1">child 1.1</div>
<div id="child-1.2">child 1.2</div>
</div><!-- .result-container -->
</div>

<script>
const speech = window.speechSynthesis;
speak("Keyboard test ready.");
const results = document.querySelector("#results");
const message = document.querySelector("#message");


document.addEventListener("focusin", e => {
speak(`${getControlName(e.target)}, ${getControlValue(e.target)}`);
}); // focus

//results.addEventListener("click", clickHandler);
document.addEventListener("click", clickHandler);

function clickHandler (e) {
speak(`click on ${getControlName(e.target)}, ${getControlValue(e.target)}`);
} // clickHandler


document.addEventListener("keydown", e => {
if (e.key === "Enter" && !e.shiftKey && !e.altKey) {
speak(`keydown ${e.key} on ${e.target.id || e.target.className}`);
e.preventDefault();
e.target.click();
} // if
}); // keydown

function status (text, element) {
//message.textContent = `${text} ${element.id || element.className}`;
speak(`${text} ${element.id || element.className}`);
} // status

function speakControl (e) {
speak(`${getControlName(e.target)}, ${getControlValue(e.target)}`);
} // speakControl

function getControlName (x) {
let name = "";
if (!x.matches) return "";
if (x.matches("a")) name = "link";
else if (x.matches("button")) name = "button";
else if (x.matches("input")) name = x.type;
else name = x.tagName;

name += ` ${x.id} ${x.className}`;
return name;
} // getControlName

function getControlValue (x) {
if (!x.matches) return "";
if (x.matches("input")) {
return `${x.getAttribute("placeholder")}, ${x.type === "checkbox"? (x.checked? "checked" : "unchecked") : x.value}`;
} else {
return x.textContent;
} // if
} // getControlValue

function speak (text) {
const utterance = new SpeechSynthesisUtterance(text);
  speech.speak(utterance);
} // speak

function $ (selector, context = document) {
return context.querySelector(selector);
} // $
</script>

</body>
</html>
